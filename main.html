<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NBF Connect - Profile Overview</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-blue: #00AEEF;
            --background-gray: #5F6D71;
            --header-dark: #292929;
            --card-white: #FFFFFF;
            --text-dark: #333333;
            --text-light: #6c757d;
            --border-color: #dee2e6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background-color: var(--background-gray);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 40px;
            overflow: hidden;
            position: relative;
        }

        .background-decor .stripe {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.05);
            z-index: 0;
        }

        .background-decor .stripe-1 {
            background-color: #48B6A3;
            width: 300px;
            height: 150vh;
            top: -25vh;
            left: 20%;
            transform: rotate(45deg);
            opacity: 0.5;
        }

        .background-decor .stripe-2 {
            background-color: #E6D861;
            width: 300px;
            height: 150vh;
            bottom: -25vh;
            right: 20%;
            transform: rotate(45deg);
            opacity: 0.5;
        }


        .profile-window {
            width: 100%;
            max-width: 1100px;
            background-color: var(--card-white);
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
            z-index: 1;
        }

        /* Header */
        .page-header {
            background-color: var(--header-dark);
            color: var(--card-white);
            padding: 12px 24px;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
        }

        .logo-area {
            line-height: 1.2;
        }

        .logo {
            font-size: 20px;
            font-weight: 400;
        }

        .tagline {
            font-size: 12px;
            color: #ccc;
        }

        .header-divider {
            width: 1px;
            height: 30px;
            background-color: #555;
            margin: 0 20px;
        }

        .page-title {
            font-size: 18px;
            font-weight: 500;
        }

        .user-info-header {
            margin-left: auto;
            display: flex;
            align-items: center;
        }

        .user-text {
            text-align: right;
            margin-right: 15px;
            line-height: 1.3;
        }

        .user-text span {
            display: block;
            font-size: 14px;
        }

        .user-text small {
            font-size: 12px;
            color: #aaa;
        }

        .header-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        .header-icons {
            display: flex;
            align-items: center;
            margin-left: 20px;
            gap: 15px;
        }

        .header-icons svg {
            cursor: pointer;
            opacity: 0.8;
            transition: opacity 0.2s;
        }
        .header-icons svg:hover {
            opacity: 1;
        }

        /* Profile Body */
        .profile-body {
            background-color: #F8F9FA;
        }

        .profile-banner {
            position: relative;
            height: 250px;
        }

        .profile-banner img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .edit-icon {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.8);
            border: 1px solid #ccc;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.2s;
        }
        .edit-icon:hover {
            background-color: white;
        }
        .edit-icon svg path {
            stroke: var(--text-dark);
        }

        .edit-cover-btn {
            width: 36px;
            height: 36px;
            bottom: 15px;
            right: 15px;
        }

        .profile-details-wrapper {
            padding: 0 40px 40px 40px;
            position: relative;
            background-color: var(--card-white);
        }

        .profile-pic-container {
            position: absolute;
            top: 0;
            left: 40px;
            transform: translateY(-50%);
            border-radius: 50%;
            padding: 6px;
            background-color: var(--card-white);
        }

        .profile-pic-container img {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            object-fit: cover;
            display: block;
        }

        .edit-profile-pic-btn {
            width: 32px;
            height: 32px;
            bottom: 10px;
            right: 10px;
        }


        /* Profile Actions and Name */
        .profile-actions {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding-top: 15px;
            margin-left: 170px; /* Space for profile picture */
            margin-bottom: 40px;
        }

        .profile-name {
            font-size: 28px;
            font-weight: 500;
            color: var(--text-dark);
            margin-bottom: 5px;
        }

        .profile-stats a {
            color: var(--primary-blue);
            text-decoration: none;
            font-size: 14px;
        }
        .profile-stats a:hover {
            text-decoration: underline;
        }

        .save-btn {
            background-color: var(--card-white);
            border: 1px solid var(--primary-blue);
            color: var(--primary-blue);
            padding: 10px 25px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        .save-btn:hover {
            background-color: var(--primary-blue);
            color: var(--card-white);
        }
        .save-btn:active {
            transform: scale(0.98);
        }

        /* Personal Details Form */
        .personal-details-section {
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        .personal-details-section h3 {
            font-size: 18px;
            font-weight: 500;
            color: var(--text-light);
            margin-bottom: 25px;
        }

        #profileForm {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px 30px;
        }

        .form-group-full {
            grid-column: 1 / -1;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            color: var(--text-light);
            margin-bottom: 8px;
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 16px;
            color: var(--text-dark);
        }
        .form-group input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 2px rgba(0, 174, 239, 0.2);
        }

        .form-group input::placeholder {
            color: #aaa;
        }

        /* Feedback Tab */
        .feedback-tab {
            position: absolute;
            top: 60%;
            right: -48px;
            transform: rotate(90deg);
            transform-origin: top left;
            background-color: var(--primary-blue);
            color: white;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            border-top-left-radius: 4px;
            border-top-right-radius: 4px;
        }


        /* Responsive Design */
        @media (max-width: 992px) {
            body {
                padding: 20px;
                align-items: flex-start;
            }
            .profile-actions {
                margin-left: 0;
                flex-direction: column;
                align-items: flex-start;
                gap: 20px;
                margin-top: 80px; /* Adjust for profile pic overlap */
            }
            #profileForm {
                grid-template-columns: 1fr;
            }
            .page-header {
                gap: 10px;
            }
            .user-info-header {
                margin-left: 0;
                flex-grow: 1;
                justify-content: flex-end;
            }
            .header-divider, .page-title {
                display: none;
            }
        }

        @media (max-width: 600px) {
            body {
                padding: 0;
            }
            .profile-window {
                border-radius: 0;
                height: 100vh;
            }
            .profile-banner {
                height: 200px;
            }
            .profile-pic-container img {
                width: 100px;
                height: 100px;
            }
            .profile-details-wrapper {
                padding: 0 20px 20px;
            }
            .profile-actions {
                margin-top: 60px;
            }
            .feedback-tab {
                display: none;
            }
        }
    </style>
</head>
<body>

    <div class="background-decor">
        <div class="stripe stripe-1"></div>
        <div class="stripe stripe-2"></div>
    </div>

    <main class="profile-window">
        <!-- Page Header -->
        <header class="page-header">
            <div class="logo-area">
                <div class="logo">NBF <strong>CONNECT</strong></div>
                <div class="tagline">Empowering SMEs</div>
            </div>
            <div class="header-divider"></div>
            <h1 class="page-title">Profile Overview</h1>
            <div class="user-info-header">
                <div class="user-text">
                    <span id="headerUserName">Jake Nackos</span>
                    <small>Last login: Feb 21 2023</small>
                </div>
                <img src="https://images.unsplash.com/photo-1580489944761-15a19d654956?q=80&w=1961&auto=format&fit=crop" alt="User Avatar" class="header-avatar" id="headerAvatar">
                <div class="header-icons">
                    <!-- Hamburger Icon SVG -->
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 12H21" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M3 6H21" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M3 18H21" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    <!-- Refresh Icon SVG -->
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M23 4V10H17" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M1 20V14H7" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M3.51 9.49C4.82255 7.42422 6.77252 5.86311 9.05533 5.03913C11.3381 4.21515 13.8214 4.18237 16.1462 4.94583C18.471 5.7093 20.5183 7.23413 21.9442 9.27891C23.3701 11.3237 24.0858 13.7745 23.9631 16.223C23.8404 18.6715 22.8881 21.0028 21.2768 22.842C19.6656 24.6812 17.4897 25.9259 15.0689 26.3769C12.6481 26.8279 10.1504 26.4619 7.97319 25.3308" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                </div>
            </div>
        </header>

        <!-- Profile Content -->
        <div class="profile-body">
            <div class="profile-banner">
                <img src="https://images.unsplash.com/photo-1501426026826-31c667b9f4d5?q=80&w=2070&auto=format&fit=crop" alt="Cover photo of a person sitting by a lake" id="coverPhoto">
                <button class="edit-icon edit-cover-btn" id="editCoverBtn" title="Edit cover photo">
                    <!-- Pencil Icon SVG -->
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                </button>
                <input type="file" id="coverFileInput" accept="image/*" hidden>
            </div>

            <div class="profile-details-wrapper">
                <div class="profile-pic-container">
                    <img src="https://images.unsplash.com/photo-1580489944761-15a19d654956?q=80&w=1961&auto=format&fit=crop" alt="Profile Picture" id="profilePic">
                    <button class="edit-icon edit-profile-pic-btn" id="editProfilePicBtn" title="Edit profile picture">
                        <!-- Pencil Icon SVG -->
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </button>
                    <input type="file" id="profilePicInput" accept="image/*" hidden>
                </div>

                <div class="profile-actions">
                    <div class="profile-name-stats">
                        <h2 class="profile-name" id="profileName">Jake Nackos</h2>
                        <div class="profile-stats">
                            <a href="#">193 followers</a> · <a href="#">21 following</a>
                        </div>
                    </div>
                    <button class="save-btn" id="saveChangesBtn">Save changes</button>
                </div>

                <div class="personal-details-section">
                    <h3>Personal details</h3>
                    <form id="profileForm">
                        <div class="form-group">
                            <label for="firstName">First name</label>
                            <input type="text" id="firstName" value="John">
                        </div>
                        <div class="form-group">
                            <label for="lastName">Last name</label>
                            <input type="text" id="lastName" value="Doe">
                        </div>
                        <div class="form-group">
                            <label for="mobileNumber">Mobile number</label>
                            <input type="tel" id="mobileNumber" value="+971 50 827 8229">
                        </div>
                        <div class="form-group">
                            <label for="emailId">Email ID</label>
                            <input type="email" id="emailId" value="john@gmail.com">
                        </div>
                        <div class="form-group form-group-full">
                            <label for="serviceProviderUrl">Service provider URL</label>
                            <input type="url" id="serviceProviderUrl" placeholder="Please enter">
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="feedback-tab">Feedback</div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- DOM ELEMENT REFERENCES ---
            const profileForm = document.getElementById('profileForm');
            const saveChangesBtn = document.getElementById('saveChangesBtn');
            
            // Inputs
            const firstNameInput = document.getElementById('firstName');
            const lastNameInput = document.getElementById('lastName');
            const mobileNumberInput = document.getElementById('mobileNumber');
            const emailIdInput = document.getElementById('emailId');
            const serviceProviderUrlInput = document.getElementById('serviceProviderUrl');

            // Display elements
            const headerUserName = document.getElementById('headerUserName');
            const profileName = document.getElementById('profileName');
            const headerAvatar = document.getElementById('headerAvatar');
            const profilePic = document.getElementById('profilePic');
            const coverPhoto = document.getElementById('coverPhoto');

            // Image upload buttons and inputs
            const editProfilePicBtn = document.getElementById('editProfilePicBtn');
            const profilePicInput = document.getElementById('profilePicInput');
            const editCoverBtn = document.getElementById('editCoverBtn');
            const coverFileInput = document.getElementById('coverFileInput');
            
            const LOCAL_STORAGE_KEY = 'nbfConnectUserProfile';
            
            // Default data for first-time load
            const defaultData = {
                firstName: "Jake",
                lastName: "Nackos",
                mobileNumber: "+971 50 827 8229",
                emailId: "jake.nackos@example.com",
                serviceProviderUrl: "",
                profilePic: "https://images.unsplash.com/photo-1580489944761-15a19d654956?q=80&w=1961&auto=format&fit=crop",
                coverPhoto: "https://images.unsplash.com/photo-1501426026826-31c667b9f4d5?q=80&w=2070&auto=format&fit=crop"
            };


            // --- FUNCTIONS ---

            /**
             * Loads profile data from localStorage. If no data is found, it uses default values.
             */
            function loadProfileData() {
                const savedData = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY));
                const data = savedData || defaultData;
                
                // Populate text inputs
                firstNameInput.value = data.firstName || '';
                lastNameInput.value = data.lastName || '';
                mobileNumberInput.value = data.mobileNumber || '';
                emailIdInput.value = data.emailId || '';
                serviceProviderUrlInput.value = data.serviceProviderUrl || '';
                
                // Update display names
                const fullName = `${data.firstName || ''} ${data.lastName || ''}`.trim();
                headerUserName.textContent = fullName || 'User';
                profileName.textContent = fullName || 'User';

                // Update images
                profilePic.src = data.profilePic;
                headerAvatar.src = data.profilePic;
                coverPhoto.src = data.coverPhoto;

                // If it's the first load, save the default data to storage
                if (!savedData) {
                    localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(data));
                }
            }

            /**
             * Saves the current form and image data to localStorage.
             */
            function saveProfileData() {
                const profileData = {
                    firstName: firstNameInput.value,
                    lastName: lastNameInput.value,
                    mobileNumber: mobileNumberInput.value,
                    emailId: emailIdInput.value,
                    serviceProviderUrl: serviceProviderUrlInput.value,
                    profilePic: profilePic.src,
                    coverPhoto: coverPhoto.src,
                };

                localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(profileData));

                // Update display names immediately
                const fullName = `${profileData.firstName} ${profileData.lastName}`.trim();
                headerUserName.textContent = fullName || 'User';
                profileName.textContent = fullName || 'User';

                // Provide user feedback
                alert('Profile saved successfully!');
            }
            
            /**
             * Handles file selection for an image element.
             * @param {Event} e - The file input change event.
             * @param {HTMLImageElement} imgElement - The image element to update.
             * @param {HTMLImageElement} [secondaryImgElement] - An optional second image element to update (e.g., header avatar).
             */
            function handleImageUpload(e, imgElement, secondaryImgElement = null) {
                const file = e.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = function(event) {
                    const imageUrl = event.target.result;
                    imgElement.src = imageUrl;
                    if (secondaryImgElement) {
                        secondaryImgElement.src = imageUrl;
                    }
                };
                reader.readAsDataURL(file);
            }


            // --- EVENT LISTENERS ---

            // Save button click
            saveChangesBtn.addEventListener('click', (e) => {
                e.preventDefault(); // Prevent form submission if it's inside a form tag
                saveProfileData();
            });

            // Profile picture upload
            editProfilePicBtn.addEventListener('click', () => profilePicInput.click());
            profilePicInput.addEventListener('change', (e) => handleImageUpload(e, profilePic, headerAvatar));

            // Cover photo upload
            editCoverBtn.addEventListener('click', () => coverFileInput.click());
            coverFileInput.addEventListener('change', (e) => handleImageUpload(e, coverPhoto));


            // --- INITIALIZATION ---
            loadProfileData();

        });
    </script>
</body>
</html>